---
published: false
layout: post
title: TV作業その１
category: tech
tags: [linux,tv,capturecard]
---

まず、ドライバのインストール。以下をそのままトレース。
http://fedorasrv.com/ivtv.shtml
カーネルをダウングレード(したくないけど)必要らしい。
以下実行。

# wgethttp://acd.ucar.edu/yum/fedora/core/updates/5/i386/kernel-2.6.16-1.2133_FC5.i686.rpm
# rpm -ivh --oldpackage kernel-2.6.16-1.2133_FC5.i686.rpm
# wgethttp://acd.ucar.edu/yum/fedora/core/updates/5/i386/kernel-devel-2.6.16-1.2133_FC5.i686.rpm
# rpm -ivh --oldpackage kernel-devel-2.6.16-1.2133_FC5.i686.rpm

再起動後、カーネル確認

$ uname -r
2.6.16-1.2133_FC5
# vi /etc/sysconfig/kernel
UPDATEDEFAULT=no
に変更。

ぱ研から、以下のドライバをダウンロードしとく。

# gunzip 0.6_svn3233-paken060421.tar.gz
# tar -xvpf 0.6_svn3233-paken060421.tar
# cd 0.6_svn3233-paken060421
# cd utils/perl
# cp ptune.pl record-v4l2.pl /usr/local/bin
# cd ../
# cp ivtvfwextract.pl /usr/local/bin

ドライバ設定。p2driverRX.sys は、CDから任意のフォルダにコピーしとく

# ivtvfwextract.pl --no-unzip p2driverRX.sys

抽出したファームウェアを所定の場所へリネーム移動

# cd /lib/modules/
# mv ivtv-fw-enc.bin /lib/firmware/v4l-cx2341x-enc.fw
# mv ivtv-fw-dec.bin /lib/firmware/v4l-cx2341x-dec.fw

設定追加
# vi /etc/modprobe.conf

読み込み実行
# modprobe ivtv

中で使ってるPerlライブラリ追加。YUMのリポジトリを追加。
# vi /etc/yum.repos.d/atrpms.repo
[atrpms]
name=Fedora Core $releasever - $basearch - ATrpms
baseurl=http://dl.atrpms.net/fc$releasever-$basearch/atrpms/stable
gpgkey=http://ATrpms.net/RPM-GPG-KEY.atrpms
gpgcheck=1
enabled=0　←　Extrasパッケージとの競合を避けるため、デフォルトは無効にしておく

インストール
# yum -y install --enablerepo=atrpms perl-Video-Frequencies perl-Video-ivtv perl-Config-IniFiles perl-Tk

ツール設定
# rm -f .ivtvrc ; record-v4l2.pl --version
# sed -i 's/^OutputSettings=.*/OutputSettings=0/g' .ivtvrc
# sed -i 's/^TunerNum=.*/TunerNum=0/g' .ivtvrc
# sed -i 's/^DirectoryFormatString=.*/DirectoryFormatString=/g' .ivtvrc
# sed -i 's/^FrequencyTable=.*/FrequencyTable=ntsc-bcast-jp/g' .ivtvrc
※どんな設定かわからんが、もとの設定を変えまくってる(コピペ物件)