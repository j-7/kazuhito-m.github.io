# 10年前「Microsoftの社員だと思って働け！」と教育されて嫌気がさして出てった人から見た"外の世界"の話(仮

とりあえず、意識を失わないためにココに書く。
まとめて、プレゼン資料に書き直す事。

## 全体的なシナリオ

最初に入った会社の出来事

↓

ソフトウェアエンジニア達が困ってきたこと

↓

やってられるか、オレはMSの世界を出る

↓

OSSの世界にはこの時点でめくるめく広さがあった

↓

仮想機とかきた(MS/OSS関係無い話し)

↓

さらに出来るように

↓

(4年前)勉強会とか行くようになったら、情報量が爆裂

↓

MSに戻ってみると…

↓

MSに期待

## 必要なパーツ

+ 軸になる年表
+ 環境を構築していく上でのパーツ表
  + OSインストール時、ミドルインストール時、アプリ設定時など

## 最初の会社のできごと

世は大クラサバWindowsアプリ時代

TODO 構成

VB,DBをクライアントとサーバとして繋ぐヤーツ。

### オブジェクト志向が花開いた時代

VB6とラショナルローズでOOな設計やってた。

でも継承もないから、フルでは出来なかった。結果として今に近い？

### インストールテスト？という仕事

一年生の三浦に「インストールテストしておいて」という指令

インストールテスト？なにそれ意味は？

--

この時期、事故が多数起こっていて

+ ライブラリ(DLL)が足りずに起動不能
+ ライブラリ(DLL)のバージョンが古くて途中アベンド
+ OSの組み合わせで異なった挙動
+ 他アプリのインストール組み合わせで不可解な動き

というのも

### 当時のインストーラの説明

当時インストーラは…。

+ 「インストーラ作成系ツール」で最終的にexeになるようにビルドするもの。
+ マイクロソフトのライブラリ、(あるなら)サードライブラリ、自前のDLL/EXE、を登録
+ インストール以外の色々(例えばデータの初期化)とかをはさみたければ、より凝った「インストーラ作成系ツール」を使う

※詳しくは[ここらへん](http://dobon.net/vb/installer/)参照

であって、ある程度ツールがサポートしてくれるものの、
たとえば「今回のリリースで新たなライブラリを参照をするようになった」などは、
入れ忘れやバージョン違いも多発し、事故も多かった。

---

そこで

クリーンなOS環境を用意 > アプリインストール > 基本データ(マスタ等)投入 > 短い代表的な業務を一通りする

という、今で言う「スモークテスト + α」をするテスト。

### 一年生に課す理由


なんでこういうのが「一年生に回ってくる」かわかります？

それは…

+ ある程度重要
+ 手順化できるくらい明確
+ しかし時間がかかる
+ 待ち時間が多い
+ が、早く終わるためには砂時計の”終わり”を見てないといけない

総じて

「面倒くさいが、手が抜けない」
「単純だが、時間がかかる」

そういう性質なんで、お鉢が回ってくるわけです。

### さらに

今回は「環境が用意してあった」からまだ楽だったわけで…

これが「環境壊れた、再度作り直し」ともなれば…

TODO 図

もう目も当てられない。

---

さて、ここらへんを鑑みてみて

## 古来より「ギョームアプリ開発者たちが戦ってきたこと」

1. 環境構築のプログラム化(〜AsCode)＆自動化
0. 環境のフリーズドライ
0. 物理筐体の用意

だったのではないかと。

### で、それを「インストールテストの環境」に当てはめてみる

…全部、時間のかかるかつ手作業かつ保存できないものじゃないか…。


## 当時のMSの印象

### 良いとこ

+ 連携取れてるところはとことん親和性が良かった
+ デザインが統一されていた
+ なんだかんだ言っても最大勢力だったから習得して損はなかった

###  やなとこ
+ 重要なとこ以外の手抜き

+ 排他的
+ 拝金主義
+ 露骨なロックイン
  + ハロウィン文書に見る
+ 方針を微妙な時間感で変える
+ プログラミングを阻む「対話型/ウィザード」GUI文化

それが「テスト環境作成＆インストールの自動化」を阻んでいる

### そんな中、三浦が感じてたのは

+ VBがいくら出来ても…
  + 落ちこぼれ扱い
    + たとえ「OOがわかっていて」も「ああ、VBプログラマでしょｗ」という扱い
    + 単価安く売られる
  + JavaとかOpen系出来るのはエリートのみ
+ 自社が「MS/Windows至上主義」で…
  + デザインガイド/MSプロダクトの設計以外設計にあらず
+ あとブラックだった

### さらに…

MSが「次バージョンからVS系全部ご破産で！.NETってのやるわ」

これは、別に悪いことではなかった。

技術者は「自身が培った技術がパラダイムシフトでご破算になること」に敏感ですし、
企業は「過去資産が使えなくなる & この先レガシーなものとなること」に敏感です。

そういうこともあり、[VB.NOT](http://www.pcmag.com/article2/0,2817,1158054,00.asp)のネガキャンやVB離れがあったのは確か

上記を踏まえて、当時、三浦個人としては…

「身につけたものが使えなくなるなら、別にここでなくても"新しいとこで新しいこと"やったらええかな？」

と思ってた。

## 「こんなところにいられるか！俺は出て行く！」

１社目をやめるとともに、OSS(主にLinuxと定番アプリ)の世界へと華麗に転身♪

…できなかったので、この線はゆったりと。

言語も、Linuxに行ったらとりあえずそのへんに転がってる(一般的ってことです)parl,(出たての)php,ark,bash触ってみたんですけど、
とりあえずJavaに落ち着かせて、それ以外に「こうなろう」を決めました。

+ 「プログラミング人並み + インフラがちょこっと解かるプログラマ」になろう
+ 主戦場は「Linux」にしよう
  + Unixの総明期には乗れなかったが、これから来るであろうLinuxには乗っておこう
  + Windowsというものはどうあがいても「職場でやらされる」やろし
  + 最終形態は「家にWindowsが無い状態で生活」
+ 自分が選んで使う道具はすべて「OSSプロダクト」にしよう


となっていったわけです

## OSS…そしてLinuxはとんでもない広い大海だった！

とにかく…量が多い！

+ 「ディストリビューション」と呼ばれる「横のバリエーション」
+ その上で走る「プログラムパッケージ」の量

とにかく広い！…けど、傾向と対策から２系統に絞って考えた。

+ 大きくはパッケージ管理で分けられる２系統

で、そのうちからRPM系のFedoraCore(現在改名Fedora)->CentOSに絞って学んでいく。

## でOSS側(というかLinux?)で同じことをしようと思うと

+ ハード調達 -> 変わらず
+ インストールディスクをIN -> PXEブート
+ OSのインストール作業(なんか色々選んだり待ったり) -> KickStart
+ ミドルやサードのアプリインストール -> パッケージ管理 + それを列挙したスクリプトの実行
---
+ ビルド -> 変わらず(専用機にソースとライブラリ集めて手動でビルド)
+ 環境選択 -> 変わらず(マルチブート)
+ 環境クリーニング -> 変わらず（関係ファイルコピー) ※テスト対象によっては開始時にchrootできる
+ テスト対象のインストール -> パッケージインストール or コマンドでビルドorどこかからコピー
+ スモーク+αテスト -> 変わらず(手動)

割と「環境構築のプログラム化(〜AsCode)」に考慮がある！

ええやんLinux！ ええやんOSS陣営！

---

ただし…

後年見てみると

PXE -> BIOSの技術なので別にLinuxに限ったものではない
Kickstart -> Widnowsにも「[Unattended Install(無人セットアップ)](http://www.watakatsu.com/windows/mujin.html)」という技術が当時あった

だった。

(もひとついうと、クライアントがLinux統一＆GUIアプリという想定も業務アプリでは稀なので…)

でもOSS陣営は…

+ 圧倒的な事例の情報量
+ コンソール文化や自動化に積極的な文化

で、「環境構築のプログラム化(〜AsCode)＆自動化」を志向している感じ。

## 世の中のギョームシステムはWebアプリケーションへ

そのうち、世のビジネスアプリのデファクトが「Webアプリケーション」に移行していきました。

自分はその頃はOSS側に居たので、Java or LL（軽量スクリプト言語）デベロッパーとして、その潮流を迎えました。

で、「個々クライアントにインストール」というものは「サーバにデプロイ」という行事に変わりました。

TODO 構成図

では、クラサバの時にやってた「インストール＆スモーク＋αテスト」はどうなったのか。

TODO 構成図(サーバのみ)

おお、構成物が減った？ (やったｗ楽になった)

と思いきや。

TODO 構成図(クライアントの組み合わせ込み)

増えてる！（げんなり） ※しかもまたようけのWindowsの組み合わせと戦う羽目に

環境の構築が楽になったのか、というと…

+ サーバサイド
  + AsCodeは以前からほぼなってる
  + 「LAMP構成のグループインストール」などより「一式でインストールできる簡易化」が進んだ
+ クライアントサイド
  + Linuxで構築するなら…
  + Windowsの構築は相変わらず手順書との格闘
    + ただし「インストール自体をしない(ソフトはブラウザ)」なので状態をもたず関連アプリのインストール作業とクリーニングの作業がなくなる

TODO わかりにくそうなので図があればGOOD

## OS仮想化の潮流

この潮流は、MS/OSS(Win/Linux)関係無く来た

なので、

win/linux ,linux/win,
p2v,v2c

なんでもござれになった。

さらにさらに、一番大きかったのは…

「環境戻し(フリーズドライ)ができるようになった」　
TODO 図

多くの仮想化のプロダクトは「OSS発祥のもの」です。


## その後自動テストやCI/CDの潮流

これは「OS」や「インフラの技術」というよりも、「Devから来た技術(開発手法)」という側面が大きいですが。

「インストール＆スモーク＋αテスト」の中で、ずっと手付かずだった「テスト」の部分に「AsCode（自動化)」の救いの手が！

### 自動テスト/継続的インテグレーション/継続的デリバリーの台頭による影響

どこに作用したかというと…

+ ビルド -> ビルドツール＆CIサーバによる自動ビルド
+ テスト -> nUnit&GUI操作ライブラリによる自動テスト


## クラウドの潮流

仮想OSがとって変わられるわけではないが「クラウドにサーバを構築」するのが容易かつリーズナブルな時代に。

### 内側だけでなく外側も

クラウドの利点は「ハードウェア調達が仮想化された」だけでなく、
「その操作がほぼAPI化＆SDK提供されている」ことによる「ハードウェア操作のプログラム化（AsCode)」
にあると考えています。

それは「OSのインストールやその設定」のような「ハードが立ってからの内部の作業」ではなく、
「サーバ同士を結線する」とか「ラックにのせる」とか「機材増設する」なんていう「物理的なハード自体を弄う外側の作業」すら、プログラミング化・自動化が可能になった、という利点かと思います。



## そして今

最近、MSの評判聞いたり、Windowsでの自動化の仕事を受けたりして、いわば「出戻ってみて」感じるのは…

「(良い意味での)隔世の感」がすごい！

ということです。

+ I love Linux前でCTOが写真撮ってる
+ VS系の言語(.NET周り)も「後発のOO」を経て円熟期に入ってる
+ なにやらOSS陣営のエバンジェリストたちが集まってきつつある
+ DevOpｓに力を入れている
+ GUIだけでなくスクリプト(AsCode)な文化が発達
+ クラウド(Azure)に力入れている
+ Linuxで開発できる手段をいろいろ提供しだした(個人的利点)
+ 最近、開発者仲間から「MS変わったらしいよ」「いいらしいよ」をよく聞く

えっ？ 俺が「気に入らん！」って言うて出てった時にの不満、ほぼ解消できんちゃう？

### 元に戻って「昔の”インストール＆スモーク＋αテスト”を現代の技術で構築」すると…

※Windows7〜10+C#で作られたDBクラサバアプリを想定

+ ハード調達 -> AWS/Azure/etc...
+ インストールディスクをIN -> 〃
+ OSのインストール作業(なんか色々選んだり待ったり) -> 〃
+ ミドルやサードのアプリインストール -> プロビジョニングツール（WinならChocorate/PS,PS DSC)
---
+ ビルド -> CIサービス or クラウドのビルドサーバ（Jenkins + ビルドツール)
+ 環境選択 -> 上記で作ったOSイメージ(AWSならAMI)を起動
+ 環境クリーニング -> 作業自体なし
+ テスト対象のインストール -> サイレントインストール
+ スモーク+αテスト -> テストプログラム実行(Frendryなどを駆使した)

（コケさえしなければ）ほぼ全自動で「答えを待つだけ」に！

※すべてをつなぐパイプラインや通知する何かは別途積まなくてはなりませんが

### これからのMSには期待しかない

## この十数年を総括して

この歴史は「ある程度SIerのど真ん中（大多数の集合）を歩いた」経歴だと思います。

その前提で総括してみます。

### ベンダー(MS)/OSSについて

___新しいものの発生とトレンドの決定の主導権が企業から民衆(OSS)に移った十数年___

自身がちょうどOSS側に注目し始めたところから、「新しい技術」や「デファクトになるようなトレンド」は
OSS側から生まれてくるようになったと思ってます。
それ以前は、MSを含む大手ベンダーが、発表し、右に倣えでトレンドになってた感じ。
今、SIerの業務システムの開発での道具の大多数はOSS由来のものである状況です。
そして、今そのMSさえ「OSSを推進する立場」に回ったと考えるなら、
今後ますますその流れに拍車がかかると思われます。

### DevOps(というよりも自動化)について

___開発者たちが「本来のコンピュータやプログラムの使い方」に立ち返った十数年___

本来、コンピュータやプログラムは「効率化・自動化のために生まれた道具」であり、
「黒い画面でEnter押したら働き続ける」ような仕事にめっぽう強い反面、
その扱い方や内部事情は難解であり、人間には辛かった。
そこで、MSなどの強大・強靭な企業が「人間に分かり良いように」と
GUI文化に尽力した。その際、開発者も利用者も「皆人類」で扱った結果、
開発者が使う道具さえ「対話型」「ウィザード型」な「人間にお伺いをたてるもの」
「連続・自動実行できないもの」が増え、「GUIでしか操作できない」開発者を多く生んだ。
その揺り戻しとして、コンソール文化や自動・連続実行できる道具など
「本来の使い方」に戻ってきた姿が、DevOpsや自動化の躍進じゃないかと。

## OSSを追いかける意味

+ 個人的な価値
  + netさえあれば誰でも利用・習熟・改良ができる（ことが多い
    + 皆にチャンスがある
  + 文化が好き
    + 「自動化」とかが好きなら

+ ビジネス的な価値
  + 現在主流となっているトレンドの大半は「OSSで技術者たちが作ったもの」が源流となっている
  + 先見の明あらば「先行者」となれる

## スーパーエンジニアの話

http://www.slideshare.net/interu07/20130302-dev-ops

これの最後に「スーパーエンジニア」という話がでてくるのですが…

---
。
上に紹介した資料自体が煽っていて、DevOpsを斜めに見てしまったことがそもそもの間違いで…

Dev/Opsで闘争したいわけじゃないのですけど、

「Devのほうが圧倒的に環境おもり(LittleOps?)している事が多いのでは？」

と思っているので、DevOps時代は「Devの人たちも臆さず活躍していける時代」なのでは無いかな？

と個人的には思っています。


## Lilo/Grubの話し
